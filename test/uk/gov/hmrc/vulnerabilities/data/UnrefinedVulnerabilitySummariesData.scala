package uk.gov.hmrc.vulnerabilities.data

import uk.gov.hmrc.vulnerabilities.model.{UnrefinedDistinctVulnerability, UnrefinedVulnerabilityOccurrence, UnrefinedVulnerabilitySummary}

import java.time.{Instant, LocalDateTime, ZoneOffset}
import java.time.temporal.ChronoUnit

object UnrefinedVulnerabilitySummariesData {

  val now: Instant = LocalDateTime.now().toInstant(ZoneOffset.UTC)

  val unrefined1 = UnrefinedVulnerabilitySummary(
    distinctVulnerability = UnrefinedDistinctVulnerability(
      vulnerableComponent = "gav://com.testxml.test.core:test-bind:1.6.8",
      description = "This is an exploit",
      fixedVersions = Some(Seq("1.6.9")),
      references = Seq("foo.com", "bar.net"),
      publishedDate = now.minus(14, ChronoUnit.DAYS)
    ),
    occurrences = Seq(
      UnrefinedVulnerabilityOccurrence(vulnComponent = "gav://com.testxml.test.core:test-bind:1.6.8", path = "test/slugs/service3/service3_3.0.4_0.0.1.tgz", componentPhysicalPath = "service3-3.0.4/some/physical/path"),
    ),
    id = "CVE-2021-99999",
    generatedDate = now,
    score = Some(7.0)
  )

  val unrefined2 = UnrefinedVulnerabilitySummary(
    distinctVulnerability = UnrefinedDistinctVulnerability(
      vulnerableComponent = "gav://com.testxml.test.core:test-bind:1.5.9",
      description = "This is an exploit",
      fixedVersions = Some(Seq("1.6.0")),
      references = Seq("foo.com", "bar.net"),
      publishedDate = now.minus(14, ChronoUnit.DAYS)
    ),
    occurrences = Seq(
      UnrefinedVulnerabilityOccurrence(vulnComponent = "gav://com.testxml.test.core:test-bind:1.5.9", path = "test/slugs/service1/service1_1.0.4_0.0.1.tgz", componentPhysicalPath = "service1-1.0.4/some/physical/path"),
      UnrefinedVulnerabilityOccurrence(vulnComponent = "gav://com.testxml.test.core:test-bind:1.5.9", path = "test/slugs/service3/service3_3.0.4_0.0.1.tgz", componentPhysicalPath = "service3-3.0.4/some/physical/path")
    ),
    id = "CVE-2022-12345",
    generatedDate = now,
    score = Some(8.0)
  )

  val unrefined3 = UnrefinedVulnerabilitySummary(
    distinctVulnerability = UnrefinedDistinctVulnerability(
      vulnerableComponent = "gav://com.testxml.test.core:test-bind:1.8.0",
      description = "This is an exploit",
      fixedVersions = Some(Seq("1.8.1")),
      references = Seq("foo.com", "bar.net"),
      publishedDate = now.minus(14, ChronoUnit.DAYS)
    ),
    occurrences = Seq(
      UnrefinedVulnerabilityOccurrence(vulnComponent = "gav://com.testxml.test.core:test-bind:1.8.0", path = "test/slugs/service4/service4_4.0.4_0.0.1.tgz", componentPhysicalPath = "service4-4.0.4/some/physical/path"),
    ),
    id = "XRAY-000004",
    generatedDate = now,
    score = None
  )

}
